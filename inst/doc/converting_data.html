<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Brian J. Knaus" />

<meta name="date" content="2022-07-14" />

<title>Converting vcfR objects to other forms</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Converting vcfR objects to other forms</h1>
<h4 class="author">Brian J. Knaus</h4>
<h4 class="date">2022-07-14</h4>



<p>Once we have finished examining our data in vcfR, we’ll want to format it so that other softwares can utilize it. A straightforward path is to create a *.vcf.gz format file. One downside to this path is that it creates an intermediate file. When working on large datasets this intermediate file may be rather large. If your path remains in R, it may be preferable to convert your vcfR objects to objects defined by other packages. Here we explore examples of these paths.</p>
<div id="data-import" class="section level2">
<h2>Data import</h2>
<p>We’ll use two datasets to illustrate data conversion. The function vcfR2genind calls adegenet::df2genind, a function which predates high throughput sequencing. This path currently doesn’t scale well to large datasets. So we’ll begin with the vcfR example dataset. This dataset consists of 19 samples with 2,533 variants. Later we’ll use the example dataset from the package pinfsc50 which includes the same samples, but with 22,0331 variants.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(vcfR)</span></code></pre></div>
<pre><code>## 
##    *****       ***   vcfR   ***       *****
##    This is vcfR 1.13.0 
##      browseVignettes(&#39;vcfR&#39;) # Documentation
##      citation(&#39;vcfR&#39;) # Citation
##    *****       *****      *****       *****</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">data</span>(vcfR_example)</span></code></pre></div>
</div>
<div id="creating-.vcf.gz-format-files." class="section level2">
<h2>Creating *.vcf.gz format files.</h2>
<p>The function <strong>write.vcf()</strong> can be used to create *.vcf.gz files (gzipped VCF files) from objects of class vcfR or chromR. These VCF files can be used for any downstream analysis which uses VCF files as input.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">write.vcf</span>(vcf, <span class="st">&quot;test.vcf.gz&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">unlink</span>(<span class="st">&quot;test.vcf.gz&quot;</span>) <span class="co"># Clean up after our example is done.</span></span></code></pre></div>
</div>
<div id="creating-genind-objects" class="section level2">
<h2>Creating genind objects</h2>
<p>The packages <strong>adegenet</strong> and <strong>poppr</strong> use objects of class <strong>genind</strong>. We can create genind objects with the function <strong>vcfR2genind()</strong>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>my_genind &lt;-<span class="st"> </span><span class="kw">vcfR2genind</span>(vcf)</span></code></pre></div>
<pre><code>## Loading required namespace: adegenet</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">class</span>(my_genind)</span></code></pre></div>
<pre><code>## [1] &quot;genind&quot;
## attr(,&quot;package&quot;)
## [1] &quot;adegenet&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>my_genind</span></code></pre></div>
<pre><code>## /// GENIND OBJECT /////////
## 
##  // 18 individuals; 2,533 loci; 5,083 alleles; size: 1.9 Mb
## 
##  // Basic content
##    @tab:  18 x 5083 matrix of allele counts
##    @loc.n.all: number of alleles per locus (range: 1-5)
##    @loc.fac: locus factor for the 5083 columns of @tab
##    @all.names: list of allele names for each locus
##    @ploidy: ploidy of each individual  (range: 2-2)
##    @type:  codom
##    @call: adegenet::df2genind(X = t(x), sep = sep)
## 
##  // Optional content
##    - empty -</code></pre>
<p>The warning is because our example dataset has uninteresting locus names (they’re all NULL). Adegenet replaces these names with slightly more interesting, unique names.</p>
<p>The function vcfR2genind calls extract.gt to create a matrix of genotypes. This matrix is converted into a genind object with the adegenet function df2genind.</p>
<p>Currently, this function does not scale well to large quantities of data. This appears to be due a call to the function adegenet::df2genind (this function was produced prior to high throughput sequencing).</p>
</div>
<div id="creating-genclone-objects" class="section level2">
<h2>Creating genclone objects</h2>
<p>The package <strong>poppr</strong> uses objects of class genclone as well as genind. Once a genind object has been created, it is fairly straight forward to create a genclone object.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>my_genclone &lt;-<span class="st"> </span>poppr<span class="op">::</span><span class="kw">as.genclone</span>(my_genind)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;pegas&#39;:
##   method      from
##   print.amova ade4</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="kw">class</span>(my_genclone)</span></code></pre></div>
<pre><code>## [1] &quot;genclone&quot;
## attr(,&quot;package&quot;)
## [1] &quot;poppr&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>my_genclone</span></code></pre></div>
<pre><code>## 
## This is a genclone object
## -------------------------
## Genotype information:
## 
##      16 original multilocus genotypes 
##      18 diploid individuals
##    2533 codominant loci
## 
## Population information:
## 
##       0 strata. 
##       0 populations defined.</code></pre>
</div>
<div id="creating-genlight-objects" class="section level2">
<h2>Creating genlight objects</h2>
<p>The <strong>genlight</strong> object is used by <strong>adegenet</strong> and <strong>poppr</strong>. It was designed specifically to handle high-throughput genotype data. At present it appears to only support two alleles at a locus, but varying levels of ploidy. Variant callers such as FreeBayes and the GATK’s haplotype caller currently support more than two alleles per locus. To address this incompatibility, vcfR2genelight omits loci that include more than two alleles. The benefit of the genlight object is that the genlight object is much more efficient to use than the genind object as it was designed with high throughput sequencing in mind. When verbose is set to TRUE the function vcfR2genlight will throw a warning and report how many loci it has omitted. When verbose is set to FALSE the loci will be omitted silently.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a>vcf_file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;pinf_sc50.vcf.gz&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;pinfsc50&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>vcf &lt;-<span class="st"> </span><span class="kw">read.vcfR</span>(vcf_file, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">vcfR2genlight</span>(vcf)</span></code></pre></div>
<pre><code>## Warning in vcfR2genlight(vcf): Found 312 loci with more than two alleles.
## Objects of class genlight only support loci with two alleles.
## 312 loci will be omitted from the genlight object.</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>##  /// GENLIGHT OBJECT /////////
## 
##  // 18 genotypes,  21,719 binary SNPs, size: 2.2 Mb
##  31239 (7.99 %) missing data
## 
##  // Basic content
##    @gen: list of 18 SNPbin
## 
##  // Optional content
##    @ind.names:  18 individual labels
##    @loc.names:  21719 locus labels
##    @chromosome: factor storing chromosomes of the SNPs
##    @position: integer storing positions of the SNPs
##    @other: a list containing: elements without names</code></pre>
</div>
<div id="creating-snpclone-objects" class="section level2">
<h2>Creating snpclone objects</h2>
<p>The <strong>genlight</strong> object is extended by the <strong>snpclone</strong> object for analysis of clonal and partially clonal populations in <strong>poppr</strong>. The genlight object can be converted to a snpclone object with functions in the poppr package.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="kw">library</span>(poppr)</span></code></pre></div>
<pre><code>## Loading required package: adegenet</code></pre>
<pre><code>## Loading required package: ade4</code></pre>
<pre><code>## 
##    /// adegenet 2.1.7 is loaded ////////////
## 
##    &gt; overview: &#39;?adegenet&#39;
##    &gt; tutorials/doc/questions: &#39;adegenetWeb()&#39; 
##    &gt; bug reports/feature requests: adegenetIssues()</code></pre>
<pre><code>## This is poppr version 2.9.3. To get started, type package?poppr
## OMP parallel support: available</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">as.snpclone</span>(x)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a>x</span></code></pre></div>
<pre><code>##  ||| SNPCLONE OBJECT |||||||||
## 
##  || 18 genotypes,  21,719 binary SNPs, size: 2.2 Mb
##  31239 (7.99 %) missing data
## 
##  || Basic content
##    @gen: list of 18 SNPbin
##    @mlg: 16 original multilocus genotypes
##    @ploidy: ploidy of each individual  (range: 2-2)
## 
##  || Optional content
##    @ind.names:  18 individual labels
##    @loc.names:  21719 locus labels
##    @chromosome: factor storing chromosomes of the SNPs
##    @position: integer storing positions of the SNPs
##    @other: a list containing: elements without names 
## 
## NULL</code></pre>
<p>Note that we now have a <strong>mlg</strong> slot to hold multilocus genotype indicators.</p>
</div>
<div id="creating-dnabin-objects" class="section level2">
<h2>Creating DNAbin objects</h2>
<p>The package <strong>ape</strong> handles sequence data using objects of class <strong>DNAbin</strong>. The VCF file only contains information on variant positions. Omitting invariant data provides for a more efficient representation of the data than including the invariant sites. Converting VCF data to sequence data presents a challenge in that these invariant sites may need to be included. This means that these objects can easily occupy large amounts of memory, and may exceed the physical memory when long sequences with many samples are included. In order to accomodate these issues, we’ve taken an approach which attempts to create DNAbin objects from portions of a chomosome, such as a gene. This means we’ll need a little more information than we’ve needed for other conversions. First, we’ll need to locate and read in our VCF file, a reference sequence and a gff file that has the coordinates for a gene.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="co"># Find the files.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a>vcf_file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;pinf_sc50.vcf.gz&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;pinfsc50&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a>dna_file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;pinf_sc50.fasta&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;pinfsc50&quot;</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a>gff_file &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;pinf_sc50.gff&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;pinfsc50&quot;</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a><span class="co"># Read in data.</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a>vcf &lt;-<span class="st"> </span><span class="kw">read.vcfR</span>(vcf_file, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true"></a>dna &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw">read.dna</span>(dna_file, <span class="dt">format=</span><span class="st">&quot;fasta&quot;</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true"></a>gff &lt;-<span class="st"> </span><span class="kw">read.table</span>(gff_file, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">quote =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>We can use information from the annotation file (gff) to extract a gene. Here we have specifically chosen one which has variants. We can use IUPAC ambiguity codes to convert heterozygous sites into a one character encoding. This results in a single sequence per individual. Alternatively, we can create two haplotypes for each diploid sample, resulting in two sequences per individual.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a>record &lt;-<span class="st"> </span><span class="dv">130</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a><span class="co"># my_dnabin1 &lt;- vcfR2DNAbin(vcf, consensus = TRUE, extract.haps = FALSE,</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a><span class="co"># gt.split=&#39;|&#39;, ref.seq=dna[,gff[record,4]:gff[record,5]],</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a><span class="co"># start.pos=gff[record,4], verbose=FALSE)</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a>my_dnabin1 &lt;-<span class="st"> </span><span class="kw">vcfR2DNAbin</span>(vcf, <span class="dt">consensus =</span> <span class="ot">TRUE</span>, <span class="dt">extract.haps =</span> <span class="ot">FALSE</span>, <span class="dt">ref.seq =</span> dna[,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a>    gff[record, <span class="dv">4</span>]<span class="op">:</span>gff[record, <span class="dv">5</span>]], <span class="dt">start.pos =</span> gff[record, <span class="dv">4</span>], <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true"></a>my_dnabin1</span></code></pre></div>
<pre><code>## 18 DNA sequences in binary format stored in a matrix.
## 
## All sequences of same length: 1043 
## 
## Labels:
## BL2009P4_us23
## DDR7602
## IN2009T1_us22
## LBUS5
## NL07434
## P10127
## ...
## 
## Base composition:
##     a     c     g     t 
## 0.238 0.295 0.272 0.194 
## (Total: 18.77 kb)</code></pre>
<p>We can visualize the variable sites using tools from the package ‘ape.’</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a>ape<span class="op">::</span><span class="kw">image.DNAbin</span>(my_dnabin1[,ape<span class="op">::</span><span class="kw">seg.sites</span>(my_dnabin1)])</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span></code></pre></div>
<p>Here, the ambiguous sites are visualized as ‘other.’ While the DNAbin object can include the ambiguity codes, not all downstream software handle these codes well. So the user should excercise prudence when using this option.</p>
<p>If we instead create two haplotypes for each diploid sample, it results in a DNAbin object which includes only unambiguous nucleotides(A, C, G and T). This typically requires the data to be phased (I use <a href="https://faculty.washington.edu/browning/beagle/beagle.html">beagle4</a>). In VCF files this is indicated by delimiting the alleles of the genotype with a pipe (‘|’) for phased data, while unphased data are delimited with a forward slash (‘/’).</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="co"># my_dnabin1 &lt;- vcfR2DNAbin(vcf, consensus=FALSE, extract.haps=TRUE,</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true"></a><span class="co"># gt.split=&#39;|&#39;, ref.seq=dna[,gff[record,4]:gff[record,5]],</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true"></a><span class="co"># start.pos=gff[record,4], verbose=FALSE)</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true"></a>my_dnabin1 &lt;-<span class="st"> </span><span class="kw">vcfR2DNAbin</span>(vcf, <span class="dt">consensus =</span> <span class="ot">FALSE</span>, <span class="dt">extract.haps =</span> <span class="ot">TRUE</span>, <span class="dt">ref.seq =</span> dna[,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true"></a>    gff[record, <span class="dv">4</span>]<span class="op">:</span>gff[record, <span class="dv">5</span>]], <span class="dt">start.pos =</span> gff[record, <span class="dv">4</span>], <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a>ape<span class="op">::</span><span class="kw">image.DNAbin</span>(my_dnabin1[,ape<span class="op">::</span><span class="kw">seg.sites</span>(my_dnabin1)])</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span></code></pre></div>
<p>Once we have a DNAbin object, it can be analysed in a number of R packages, such as ape and pegas. We can also output a fasta file for other softwares to use.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="kw">write.dna</span>( my_dnabin1, <span class="dt">file =</span> <span class="st">&#39;my_gene.fasta&#39;</span>, <span class="dt">format =</span> <span class="st">&#39;fasta&#39;</span> )</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a><span class="kw">unlink</span>(<span class="st">&#39;my_gene.fasta&#39;</span>) <span class="co"># Clean up after we&#39;re done with the example.</span></span></code></pre></div>
<p>Also see:</p>
<ul>
<li>Heng Li’s <a href="https://github.com/lh3/seqtk">seqtk</a></li>
<li><a href="https://software.broadinstitute.org/gatk/">GATK’s</a> FastaAlternateReferenceMaker</li>
</ul>
</div>
<div id="creating-loci-objects" class="section level2">
<h2>Creating loci objects</h2>
<p>The package <strong>pegas</strong> uses objects of class <strong>loci</strong>. We can use the function vcfR2loci to convert our vcfR object to one of class loci.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="kw">system.time</span>( my_loci &lt;-<span class="st"> </span><span class="kw">vcfR2loci</span>(vcf) )</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true"></a><span class="kw">class</span>(my_loci)</span></code></pre></div>
<p>This takes a noticable amount of time to execute but is effective. We can now proceed to downstream analyses.</p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>The use of vcfR is an intermediary point in an analysis. Once VCF data are obtained, vcfR provides an interactive way to scrutinize and filter the data. A number of paths have been provided that take the results of VCF format data from exploration and filtering to downstream analyses by other software that uses VCF files as input or several R packages.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
